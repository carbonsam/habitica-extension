"use strict";function loadSettings(){console.log(chrome.storage.local.get("user_id"));var e=chrome.storage.local.get("user_id"),t=chrome.storage.local.get("user_key");void 0!==e&&void 0!==t?makeApiRequest("https://habitica.com/api/v3/user",[{header:"x-api-user",value:e},{header:"x-api-key",value:t}]):window.open("settings.html")}function updatePopup(e){USER_IMG_ELEMENT.src="https://habitica.com/export/avatar-"+USER_ID+".png",USER_HEALTH_BAR_ELEMENT.style="width: "+e.data.stats.hp/e.data.stats.maxHealth*100+"%",USER_HEALTH_VALUE_ELEMENT.innerHTML=Math.round(e.data.stats.hp)+" / "+e.data.stats.maxHealth,USER_EXPERIENCE_BAR_ELEMENT.style="width: "+e.data.stats.exp/e.data.stats.toNextLevel*100+"%",USER_EXPERIENCE_VALUE_ELEMENT.innerHTML=e.data.stats.exp+" / "+e.data.stats.toNextLevel,USER_GOLD_VALUE_ELEMENT.innerHTML=Math.round(e.data.stats.gp),USER_LEVEL_VALUE_ELEMENT.innerHTML="Level "+e.data.stats.lvl,console.log(e)}function createApiRequest(e,t){var E=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=new XMLHttpRequest;return"withCredentials"in a&&a.open(e,t,!0),E.forEach(function(e){a.setRequestHeader(e.header,e.value)}),a}function makeApiRequest(e,t){var E=createApiRequest("GET",e,t);E.onload=function(){window.testData=JSON.parse(E.responseText),updatePopup(JSON.parse(E.responseText))},E.onerror=function(){},E.send()}function onConnectFormSubmit(){var e=USER_ID_FIELD.value,t=USER_API_KEY_FIELD.value;chrome.storage.local.set({user_id:e,user_key:t},onSaveSuccess())}function onSaveSuccess(){window.open("dashboard.html")}var USER_IMG_ELEMENT=document.getElementById("hero_image"),USER_HEALTH_BAR_ELEMENT=document.getElementById("hero_health_bar"),USER_HEALTH_VALUE_ELEMENT=document.getElementById("hero_health_value"),USER_EXPERIENCE_BAR_ELEMENT=document.getElementById("hero_experience_bar"),USER_EXPERIENCE_VALUE_ELEMENT=document.getElementById("hero_experience_value"),USER_GOLD_VALUE_ELEMENT=document.getElementById("hero_gold_value"),USER_LEVEL_VALUE_ELEMENT=document.getElementById("hero_level_value");loadSettings();var CONNECT_FORM=document.getElementById("connect-form"),USER_ID_FIELD=document.getElementById("user-id-text"),USER_API_KEY_FIELD=document.getElementById("user-api-key-text");CONNECT_FORM.addEventListener("submit",onConnectFormSubmit);